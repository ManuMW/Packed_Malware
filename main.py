
import os.path
import pefile
import peutils

if __name__ == '__main__':
    file = r'C:\Users\ASUS\Downloads\Testing\ADE_4.5_Installer.exe'
    my_file = os.path.abspath(file)
    signatures = peutils.SignatureDatabase(r'C:\Users\ASUS\PycharmProjects\Packed Malware\userdb.txt')

    pe = pefile.PE(my_file)
    print("Sections: ", end='')
    print("\t\tEntropy\n")
    for sect in pe.sections:
        print("%17s" % (sect.Name).decode('utf-8'), end='')
        print(("\t%5.2f" % sect.get_entropy()))
    matches = signatures.match(pe, ep_only=True)
    print(matches)
    print("The entry point of the file is: ",pe.OPTIONAL_HEADER.AddressOfEntryPoint)

    if matches == None:
        print(pe.sections)