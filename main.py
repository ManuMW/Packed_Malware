
import os.path
import peutils
import pefile

def detection():
    signatures = peutils.SignatureDatabase('/path/to/signature.txt')


if __name__ == '__main__':
    file = r'C:\Users\ASUS\Downloads\upx-3.96-win64\upx-3.96-win64\junky_packed'
    my_file = os.path.abspath(file)
    pe = pefile.PE(my_file)
    print("Sections: ", end='')
    print("\t\tEntropy\n")
    for sect in pe.sections:
        print("%17s" % (sect.Name).decode('utf-8'), end='')
        print(("\t%5.2f" % sect.get_entropy()))

    print("The entry point of the file is: ",pe.OPTIONAL_HEADER.AddressOfEntryPoint)
    if pe.OPTIONAL_HEADER.AddressOfEntryPoint == None:
        print("The file is packed")
    else:
        print("The file may not be packed")

    if sect.get_entropy() > 6.5:
        print("The file packed")
        detection()