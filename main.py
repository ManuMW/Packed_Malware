
import os.path
import pefile
import peutils
from static_unpack import *




#if __name__ == '__main__':
    #print("antidebugging")
    # file = r'C:\Users\ASUS\Downloads\Testing\ADE_4.5_Installer.exe'
    # my_file = os.path.abspath(file)
    # pe = pefile.PE(my_file)
    # file2 = r'C:\Users\ASUS\Downloads\Testing\ADE_4.5_Installer.exe'
    # signatures = peutils.SignatureDatabase(r'C:\Users\ASUS\PycharmProjects\Packed Malware\userdb.txt')
    #
    #
    # print("Sections: ", end='')
    # print("\t\tEntropy\n")
    # for sect in pe.sections:
    #     print("%17s" % (sect.Name).decode('utf-8'), end='')
    #     print(("\t%5.2f" % sect.get_entropy()))
    #     if sect.get_entropy() > 6.8:
    #         print("Packed section (Maybe) ""%17s"% (sect.Name).decode('utf-8'))
    # matches = signatures.match(pe, ep_only=True)
    # print(matches)
    # print("The entry point of the file is: ",pe.OPTIONAL_HEADER.AddressOfEntryPoint)
    #
    # if matches == None:
    #     print("Need to upgrade the signature database")


